{"version":3,"sources":["../src/index.test.js"],"names":["test","expect","toBe","rules","op","res","resources","name","children","enrichedResources","displayName","not","toEqual"],"mappings":"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","file":"index.test.js","sourcesContent":["import { ressourceMatches, checkRule, enrichResources } from './index'\n\ntest('ressourceMatches', () => {\n  expect(ressourceMatches('', '')).toBe(true)\n  expect(ressourceMatches('*', 'everything.will.match')).toBe(true)\n  expect(ressourceMatches('everything.*', 'everything.will.match')).toBe(true)\n  expect(ressourceMatches('everything.*.match', 'everything.here.match')).toBe(true)\n  expect(ressourceMatches('everything.*.match.again', 'everything.here.match.again')).toBe(true)\n  expect(ressourceMatches('everything.*.*.again', 'everything.here.match.again')).toBe(true)\n  expect(ressourceMatches('*.will.*.again', 'everything.will.match.again')).toBe(true)\n  expect(ressourceMatches('everything', 'everything.will.match')).toBe(true)\n\n  expect(ressourceMatches('', 'nothing.will.match')).toBe(false)\n  expect(ressourceMatches('nothing.match', 'nothing.will.match')).toBe(false)\n  expect(ressourceMatches('this.*.match', 'nothing.will.match')).toBe(false)\n  expect(ressourceMatches('*.*.match', 'nothing.will.work')).toBe(false)\n  expect(ressourceMatches('a.b.c', 'b.a.c')).toBe(false)\n  expect(ressourceMatches('*.b.c', 'b.a.c')).toBe(false)\n})\n\ntest('checkRule', () => {\n  const rules = [\n    // 2 chars\n    { op: '+r', res: '1' },\n    { op: '-w', res: '1' },\n    { op: '+w', res: '1.a' },\n    // 3 chars\n    { op: '+rw', res: '2' },\n    { op: '-rw', res: '2.a' },\n    { op: '+r', res: '2.a.b' },\n    // 4 chars\n    { op: '+r+w', res: '2.a.c' },\n    { op: '+r-w', res: '3' },\n    { op: '+w-r', res: '3.a' }\n  ]\n\n  expect(checkRule(null, 'read', '1')).toBe(false)\n  expect(checkRule(rules, 'read', '1')).toBe(true)\n  expect(checkRule(rules, 'write', '1')).toBe(false)\n  expect(checkRule(rules, 'write', '1.a')).toBe(true)\n  expect(checkRule(rules, 'write', '1.b')).toBe(false)\n  expect(checkRule(rules, 'read', '1.b')).toBe(true)\n\n  expect(checkRule(rules, 'read', '2')).toBe(true)\n  expect(checkRule(rules, 'write', '2')).toBe(true)\n  expect(checkRule(rules, 'read', '2.b')).toBe(true)\n  expect(checkRule(rules, 'write', '2.b')).toBe(true)\n  expect(checkRule(rules, 'read', '2.a')).toBe(false)\n  expect(checkRule(rules, 'write', '2.a')).toBe(false)\n  expect(checkRule(rules, 'write', '2.a.b')).toBe(false)\n  expect(checkRule(rules, 'read', '2.a.b')).toBe(true)\n  expect(checkRule(rules, 'read', '2.a.c')).toBe(true)\n  expect(checkRule(rules, 'write', '2.a.c')).toBe(true)\n\n  expect(checkRule(rules, 'read', '3')).toBe(true)\n  expect(checkRule(rules, 'write', '3')).toBe(false)\n  expect(checkRule(rules, 'write', '3.a')).toBe(true)\n  expect(checkRule(rules, 'read', '3.a')).toBe(false)\n})\n\ntest('enrichResources', () => {\n  const resources = [\n    {\n      name: 'x',\n      children: [\n        {\n          name: 'y',\n          children: [\n            {\n              name: 'z'\n            }\n          ]\n        },\n        {\n          name: 't'\n        }\n      ]\n    },\n    {\n      name: '1',\n      children: [\n        {\n          name: '2'\n        },\n        {\n          name: '3',\n          children: [\n            {\n              name: 'a'\n            }\n          ]\n        }\n      ]\n    }\n  ]\n\n  const enrichedResources = [\n    {\n      displayName: 'x',\n      name: 'x',\n      children: [\n        {\n          displayName: 'y',\n          name: 'x.y',\n          children: [\n            {\n              displayName: 'z',\n              name: 'x.y.z'\n            }\n          ]\n        },\n        {\n          displayName: 't',\n          name: 'x.t'\n        }\n      ]\n    },\n    {\n      displayName: '1',\n      name: '1',\n      children: [\n        {\n          displayName: '2',\n          name: '1.2'\n        },\n        {\n          displayName: '3',\n          name: '1.3',\n          children: [\n            {\n              displayName: 'a',\n              name: '1.3.a'\n            }\n          ]\n        }\n      ]\n    }\n  ]\n\n  expect(enrichResources(resources)).not.toBe(resources)\n  expect(enrichResources(resources)).toEqual(enrichedResources)\n})\n"]}